# 16. 앱 스토어와 구글 플레이에 리액트 네이티브 앱 등록하기

## 16.1 프로젝트 준비하기

- 프로젝트 이름이 고유해야 하므로, 새 프로젝트를 만들 때 닉네임을 포함해서 만들면 좋다

## 16.2 안드로이드 앱 등록하기

### 16.2.1 앱 서명하기

- 구글 플레이에 앱을 등록하려면 릴리스 키를 사용하여 앱에 디지털 서명을 해야 합니다
- 디지털 서명은 앱 개발자임을 증명하는 수단으로, 앱 제작자가 아닌 타인이 앱을 업데이트 하는 것을 방지할 수 있습니다
- 릴리스 키 파일 생성

```
keytool -genkeypair -v -storetype PKCS12 -keystore app-release-key.keystore -alias app-release -keyalg RSA -keysize 2048 -validity 10000
```

- `app-release-key.keystore` 파일이 현재 경로에 만들어짐

  - 이 파일을 android/app 경로에 옮겨주세요

- android/gradle.properties 파일을 열어서 최하단에 인증서에 대한 정보를 다음과 같이 입력해주세요

```
(...)
RELEASE_STORE_FILE=app-release-key.keystore
RELEASE_KEY_ALIAS=app-release
RELEASE_STORE_PASSWORD=******
RELEASE_KEY_PASSWORD=******
```

- 비밀번호는 키를 만들 때 입력했던 비밀번호를 입력해주세요

- android/app/build.gradle 파일에서 방금 설정한 값들을 불러와 사용해보자
  - signingConfigs와 buildTypes 부분을 아래와 같이 변경

```
signingConfigs {
        debug {
            (...)
        }
        release {
            if (project.hasProperty('RELEASE_STORE_FILE')) {
                storeFile file(RELEASE_STORE_FILE)
                storePassword RELEASE_STORE_PASSWORD
                keyAlias RELEASE_KEY_ALIAS
                keyPassword RELEASE_KEY_PASSWORD
            }
        }
    }
buildTypes {
    debug {
        signingConfig signingConfigs.debug
    }
    release {
        signingConfig signingConfigs.release
        (...)
    }
}
```

### 16.2.2 AAB 파일 생성하기

- AAB : Android App Bundle

```
cd android
./gradlew bundleRelease
```

- APK이 더 익숙할 수 있다
- 안드로이드에서 앱을 설치할 때 사용하는 것은 APK파일이 맞다
- 하지만 앱을 스토어에 등록할 땐 각 안드로이드 기기 설정에 맞게 최적화된 APK를 생성해야 합니다
- 이때 AAB파일을 사용하여 구글 플레이에 등록하면, 구글 플레이에서 APK 생성 및 서명 작업이 이루어집니다
- 이 명령어 수행이 끝나면 android/app/build/output/bundle/release 경로에 app-release.aab 파일이 생성됩니다
  - 이 파일을 구글 플레이에 업로드하여 앱을 배포하면 됩니다

### 16.2.3 릴리스 빌드 실행해보기

- 구글 플레이에 출시하기 전에 안드로이드 기기에서 릴리스 빌드가 잘 작동하는지 검토
- 개발 빌드가 아닌 릴리스 빌드를 시뮬레이터 또는 실제 디바이스에서 실행하기 위해 아래 명령어를 입력

```
npx react-native run-android --variant=release
```

### 16.2.4 구글 플레이에 앱 등록하기

- https://play.google.com/console

  - 새 개발자 계정을 만들 때는 $25를 결제해야 합니다
    - 결제 시 해외 결제가 가능한 카드 필요

- 앱 만들기 버튼
- 새 버전 만들기
- 서명 후 AAB 파일을 업로드
  - 앱을 처음 등록하는 경우 '아직 앱을 게시할 수 없습니다. 앱 대시보드에 안내된 단계를 완료하세요'라는 오류가 나옴
  - 대시 보드로 가서 앱 등록 정보, 국가 및 지역 등을 작성 -> 앱 출시 가능
